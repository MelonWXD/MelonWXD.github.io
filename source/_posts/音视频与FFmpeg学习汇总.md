---
title: 音视频与FFmpeg学习汇总
date: 2018-07-07 15:52:02
tags: [音视频]  
categories: Android
---

对近期学习做一个总结，来滴Z爱2个多月，一篇文章都没写，心累。

<!-- more -->  

# 基本概念

先上一个音视频文件播放流程图，然后从视频播放的角度来逐点介绍整个流程：

![](http://owu391pls.bkt.clouddn.com/%E6%96%87%E4%BB%B6%E6%92%AD%E6%94%BE%E6%B5%81%E7%A8%8B2.jpg)

## 封装格式

我们常见的**音视频**文件格式，诸如avi、mp4和rmvb都是封装格式。

为什么需要封装格式，这不难理解，把音频和视频封装到一个文件，或者说一个容器中嘛。

## 经过编码的视频数据

常见的视频编码格式有 mpeg-4 、 h.264 等 具体可以见参考中的网址

为什么要把视频数据进行编码？是为了提高网络传输效率。

先来算一笔简单的账：

视频我们都知道，是由一帧又一帧的图片连续显示组成的。假设有个帧率为20的1080*720分辨率的视频，1秒播放20张图片，每一帧图片用的是RGB565格式，即一个像素点占16bit。

那么根据上面已知条件，可以计算出想要在线播放这段视频时需要的网速应该要 `20x1080x720x16/8 =31104000 `，即29M/s，显然不现实，这还是往小了说。

## 原始视频数据

解析上述的编码格式就得到视频原始数据，至于怎么解析的下面会另外介绍基于H.264的视频解码过程。

原始的视频数据主要有yuv和rgb两种，YUV420，YUV422，RGB24等等，具体的下面也会另外介绍。

现在我们拿到了每一帧的原始数据，输入播放器，播放器再去操作底层的一堆fb来显示每一帧，就达到播放视频的目的了。



# 表示颜色的几种格式

## RGB

作为android开发最熟悉的就是rgb格式了，

在RGB颜色空间中，任意色光F都可以用R、G、B三色不同分量的相加混合而成：F=r[R]+r[G]+r[B]

![](https://images2015.cnblogs.com/blog/536358/201703/536358-20170318083044510-544926603.jpg)



## HSV

HSV是一种将RGB色彩空间中的点在倒圆锥体中的表示方法。HSV即色调(Hue)、饱和度(Saturation)、明度(Value)，又称HSB(B即Brightness)。

色调H：一些基础颜色

饱和度S：用过ps就很好理解这个了，我理解的话是色彩的鲜艳程度，S=0就是灰度化

明度V：就是亮度了，看右图就很好理解了，V=0就是暗的一B，黑色，V=max，就是亮瞎狗眼，白色。

![](https://images2015.cnblogs.com/blog/536358/201703/536358-20170320140444158-1965908932.jpg)





## YUV

YUV则是把颜色用一种更直接抽象的方式来表达，“Y”表示明亮度，“U”和“V” 表示的则是色度。Y是通过RGB信号特定部分叠加得到的，UV则用来反应颜色的色调和饱和度。分别用Cr和Cb来表示。其中，Cr反映了RGB输入信号红色部分与RGB信号亮度值之间的差异。而Cb反映的是RGB输入信号蓝色部分与RGB信号亮度值之间的差异。

采用YUV色彩空间的重要性是它的亮度信号Y和色度信号U、V是分离的。如果只有Y信号分量而没有U、V分量，那么这样表示的图像就是黑白。



# Todo

# H.264



如上面介绍的一样，h264是一种视频的编码格式，那么h264是如何编码的？



 

![](http://p.blog.csdn.net/images/p_blog_csdn_net/wanggp_2007/EntryImages/20091120/slice.png)



# FFmpeg























# 参考

[常见视频编码格式解析](https://blog.csdn.net/houxiaoni01/article/details/78812485/)

[颜色空间模型](https://www.cnblogs.com/justkong/p/6570914.html)